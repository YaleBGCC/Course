<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Erica Stuber: efstuber@gmail.com" />

<meta name="date" content="2019-01-31" />

<title>Lab 2 - Species Distribution Models</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="cm_yeti_bootswatch.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ecology, Statistics, and Data Science with R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Head2_Schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Course Materials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Head1_CourseContent.html">About Course Content</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Module 1: Introduction to R</li>
    <li>
      <a href="00_CourseIntroductionFrame.html">1.0 Course Introduction</a>
    </li>
    <li>
      <a href="01_Rintro.html">1.1 First Steps</a>
    </li>
    <li>
      <a href="02_DataWrangling.html">1.2 Data Wrangling</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Module 2: Spatial Analysis in R</li>
    <li>
      <a href="05_Raster.html">2.1 Spatial Data</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Module 3: Species Distribution Models</li>
    <li>
      <a href="101SDMs.html">3.1 Basic SDMS</a>
    </li>
    <li>
      <a href="110_SDMs_Integrating_Data_Types.html">3.2 Integrating data types in SDMS</a>
    </li>
    <li class="divider"></li>
  </ul>
</li>
<li>
  <a href="Head3_Resources.html">Resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cmerow/RDataScience/tree/gh-pages">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Lab 2 - Species Distribution Models</h1>
<h4 class="author"><em>Erica Stuber: <a href="mailto:efstuber@gmail.com">efstuber@gmail.com</a></em></h4>
<h4 class="date"><em>January 31, 2019</em></h4>

</div>


<div>
<iframe src="https://raw.githubusercontent.com/YaleBGCC/Course/master/efs_sdm_assets/YaleCoursesSDM2.pdf" width="100%" height="700px">
</iframe>
</div>
<div>
<object data="efs_sdm_assets/YaleCoursesSDM2.pdf" type="application/pdf" width="100%" height="600px">
<p>
It appears you don’t have a PDF plugin for this browser. No biggie… you can <a href="https://raw.githubusercontent.com/YaleBGCC/Course/master/efs_sdm_assets/YaleCoursesSDM2.pdf">click here to download the PDF file.</a>
</p>
</object>
</div>
<p>
<a href="https://raw.githubusercontent.com/YaleBGCC/Course/master/efs_sdm_assets/YaleCoursesSDM2.pdf">Download the PDF of the presentation</a>
</p>
<div id="lab-exercise-steps" class="section level2">
<h2><span class="header-section-number">0.1</span> Lab Exercise steps</h2>
<p>We will perform a regression-based species distribution analysis using avian occurrence data (Parus major), and landsat-derived remote-sensing data. 12 field sites were surveyed for occurrence of birds roosting or nesting in nestboxes. Sampling sites (boxes) were located approximately ~50m apart in a gridded fashion within larger forest plots. Sites were recorded for presence of a nesting or roosting individual. Environmental data (landsat bands 1-5, ndvi, ndvi variance, elevation, slope, and aspect) were associated with each box location.</p>
<div id="parus-major-study-design" class="section level3">
<h3><span class="header-section-number">0.1.1</span> Parus major study design</h3>
<p><img src="efs_sdm_assets/GRTI.png" alt="alt text" width="70%"></p>
<p>12 nestbox sites were established between lake Herrsching and lake Starnberg in Bavaria, Germany ~2012. Each field site had 50 nestboxes, and sites varied in their overall bird density.</p>
</div>
<div id="objectives-for-the-lab" class="section level3">
<h3><span class="header-section-number">0.1.2</span> Objectives for the lab:</h3>
<ol style="list-style-type: decimal">
<li>Consider which environmental variables might be important for determining whether a bird might be present or absent from a sampling site.</li>
<li>Conduct a regression analysis using your selected predictors.</li>
<li>Check your residuals for left over spatial autocorrelation.</li>
<li>Project the estimated relationships over the greater Starnberg-Herrsching area.</li>
</ol>
</div>
</div>
<div id="setup" class="section level2">
<h2><span class="header-section-number">0.2</span> Setup</h2>
<p>You will need the following packages installed and loaded:</p>
<pre class="r"><code>library(lme4)
library(sp)
library(raster)
library(corrplot)
library(gstat)
library(DAAG) 
library(PresenceAbsence)
library(dplyr)</code></pre>
</div>
<div id="load-the-data" class="section level1">
<h1><span class="header-section-number">1</span> Load the data</h1>
<pre class="r"><code>require(sp)
occu&lt;-read.csv(&quot;https://raw.githubusercontent.com/YaleBGCC/Course/master/efs_sdm_assets/GT_Occur.csv&quot;, sep=&quot;,&quot;,header=TRUE)</code></pre>
<p>Check out the structure of the data: <strong>str()</strong>. And get an idea of what the data look like: <strong>head()</strong>.</p>
<div class="well">
<h2 id="your-turn"><span class="header-section-number">1</span> Your turn</h2>
<p>Promote your dataframe “occu” to a “SpatialPointsDataFrame” (just like last week!):</p>
<ol style="list-style-type: decimal">
<li>Find the columns with the lat long coordinates</li>
<li>Tell R which data are coordinates</li>
<li>Combine the coordinates data with the ‘rest’ of the data in occu</li>
</ol>
<p><em>Hint</em>: R likes coordinates to be ordered as <strong>‘longlat’</strong>, so when assigning coordinates indicate the longitude column before the latitude column</p>
<button data-toggle="collapse" class="btn btn-primary btn-sm round" data-target="#demo2">
Show Solution
</button>
<div id="demo2" class="collapse">
<pre class="r"><code>sp = SpatialPoints(occu[,c(5,4)])
spdf = SpatialPointsDataFrame(sp, occu)
# OR
spdf = SpatialPointsDataFrame(occu[,c(5,4)], occu)

plot(spdf)</code></pre>
<p><img src="efs_sdm_files/figure-html/unnamed-chunk-2-1.png" /><!-- --></p>
</div>
</div>
<div id="spatial-data-should-have-a-projection" class="section level3">
<h3><span class="header-section-number">1.0.1</span> Spatial data should have a <strong>projection</strong></h3>
<p>Does the data already have a projection assigned? Try the <strong>proj4string()</strong> function to look at the data.</p>
<p>We should tell R what projection our coordinate data are in: <em>“longlat”</em>.</p>
<pre class="r"><code>occ_spdf &lt;- spTransform(SpatialPointsDataFrame(coords = occu[,c(5,4)], data = occu,
                               proj4string = CRS(&quot;+proj=longlat&quot;)),CRS(&quot;+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;))  ##spatial locations of point count sampling sites</code></pre>
</div>
</div>
<div id="explore-the-predictors" class="section level1">
<h1><span class="header-section-number">2</span> Explore the predictors</h1>
<div id="load-in-the-raster-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Load in the raster data</h2>
<p>These raster layers contain environmental information based on Landsat 7 images, and a digital elevation model</p>
<pre class="r"><code>#I haven&#39;t found an elegant way to get this data- on mac the following code might work, but on a windows machine you might need to manually download the files from the github page: http://github.com/YaleBGCC/Course/efs_sdm_assets/
require(raster)
#you would need to change the directory to match a path on your own local machine
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/B1.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/B1.tif&quot;)
 B1 &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/B1.tif&quot;)
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/B2.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/B2.tif&quot;)
 B2 &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/B2.tif&quot;)
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/B3.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/B3.tif&quot;)
 B3 &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/B3.tif&quot;)
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/B4.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/B4.tif&quot;)
 B4 &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/B4.tif&quot;)
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/B5.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/B5.tif&quot;)
 B5 &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/B5.tif&quot;)
# 
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/NDVI.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/NDVI.tif&quot;)
 NDVI &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/NDVI.tif&quot;)
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/NDVItext.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/NDVItext.tif&quot;)
 NDVItext &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/NDVItext.tif&quot;)
# 
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/Elevation.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/Elevation.tif&quot;)
 Elev &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/Elevation.tif&quot;)
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/Slope.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/Slope.tif&quot;)
 Slope &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/Slope.tif&quot;)
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/Aspect.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/Aspect.tif&quot;)
 Aspect &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/Aspect.tif&quot;)
# download.file(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/Dist_to_path.tif&quot;, destfile = &quot;C:/Users/Erica Stuber/Desktop/Dist_to_path.tif&quot;)
 Dist_to_path &lt;- raster(&quot;C:/Users/Erica Stuber/Desktop/Dist_to_path.tif&quot;)

occ_stack &lt;- stack(B1,B2,B3,B4,B5,NDVI,NDVItext,Elev,Slope,Aspect,Dist_to_path)

## OR

#load(url(&quot;https://github.com/YaleBGCC/Course/raw/master/efs_sdm_assets/occ_stack.RData&quot;))

plot(occ_stack[[1]])
points(occ_spdf)</code></pre>
<p><img src="efs_sdm_files/figure-html/unnamed-chunk-3-1.png" /><!-- --></p>
</div>
<div id="what-do-landsat-data-mean" class="section level2">
<h2><span class="header-section-number">2.2</span> What do Landsat data mean?</h2>
<p>For example, each band measures ‘reflectance’, which can represent some biologically relevant characteristics. <a href="https://landsat.usgs.gov/what-are-best-spectral-bands-use-my-study">LandSat7 band characteristics</a>.</p>
<p><strong>What variables might be most relevant in predicting bird occurrence?</strong> (e.g., Parus major, a forest-bird)</p>
<div id="consider-the-predictors-and-data-structure" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Consider the predictors and data structure</h3>
<p>Make some histograms of your predictors. Do they differ in the range or variance of their values?</p>
<pre class="r"><code>hist(occ_spdf$B1)</code></pre>
<p><img src="efs_sdm_files/figure-html/data%20exploration-1.png" /><!-- --></p>
<p><strong>Are the data highly correlated?</strong></p>
<p>Many LandSat variables are strongly correlated with one another, which can confound statistical analyses without huge amounts of data.</p>
<blockquote>
<p>Decision: Correlated predictors can make it difficult to interpret model coefficients or response curves. So we’ll remove the most correlated predictores</p>
</blockquote>
<pre class="r"><code># check for correlated predictors
cors=cor((occu[,13:23]),use=&#39;complete.obs&#39;) # evaluate correlations
corrplot(cors,order = &quot;AOE&quot;, addCoef.col = &quot;grey&quot;,number.cex=.6) # plot correlations</code></pre>
<p><img src="efs_sdm_files/figure-html/unnamed-chunk-4-1.png" /><!-- --></p>
<p><strong>What predictors might be relevant in predicting species occurrence that aren’t too highly correlated with each other?</strong></p>
<p><em>Rule of Thumb</em>: a general rule is to keep your between-predictor correlations below 0.7, unless you have lots (thousands) of data points to play with</p>
</div>
</div>
</div>
<div id="make-a-regression-based-sdm" class="section level1">
<h1><span class="header-section-number">3</span> Make a regression-based SDM</h1>
<div class="well">
<h2 id="your-turn-1"><span class="header-section-number">3</span> Your turn</h2>
<p>Come up with a regression model using your chosen predictors:</p>
<ol style="list-style-type: decimal">
<li>occu$Occur contains occurrence data (0,1) - what ‘family’ regression model does this naturally fit? (Gaussian, Poisson, Binomial, etc.)</li>
<li>List your predictor variables to include</li>
<li>Write your model in R’s lme4 package syntax: sdm &lt;- (response_variable ~ fixed_predictor1 + fixed_predictor2, family=“insert_your_chosen_family_here”, data=occu)</li>
</ol>
<p><em>Hint</em>: just before “(response_variable” you need to add a model function- this will either be lm or glm, depending on what ‘family’ you choose</p>
<button data-toggle="collapse" class="btn btn-primary btn-sm round" data-target="#demo3">
Show Solution
</button>
<div id="demo3" class="collapse">
<pre class="r"><code>sdm&lt;-glm(Occur~ B1 + B4 + NDVI + Slope + Aspect + Dist_to_path, family=&quot;binomial&quot;, data=occu) ##this is just an example- you could have different chosen predictors</code></pre>
</div>
</div>
<div id="check-for-residual-spatial-autocorrelation" class="section level2">
<h2><span class="header-section-number">3.1</span> Check for residual spatial autocorrelation</h2>
<p>Before we get ahead of ourselves and look at model estimates, we should first check whether there is any spatial autocorrelation left unexplained by the model. If there is substantial spatial correlation, we shouldn’t believe too much in the estimates we get… instead we should reformulate the model to better capture relevant patterns in the data.</p>
<pre class="r"><code>### have a look at your residuals
require(sp)
require(gstat)
spdata &lt;- data.frame(resid=rstandard(sdm), x=occu$latitude, y=occu$longitude)
coordinates(spdata) &lt;- c(&quot;x&quot;, &quot;y&quot;)
bubble(spdata, &quot;resid&quot;, col=c(&quot;blue&quot;, &quot;orange&quot;), main=&quot;Residuals&quot;,xlab=&quot;X-coordinates&quot;, ylab=&quot;Y-coordinates&quot;, alpha=0.05)</code></pre>
<p><img src="efs_sdm_files/figure-html/bubble%20model-1.png" /><!-- --></p>
<p>The size of the bubble represents the magnitude of the residual, and color represents sign/direction (blue = negative, orange = positive) of the residual. Its hard to see any patterns across the entire study extent (12 plots), so we can zoom in to check out individual field sites by subsetting the data to occu$Plot== and a plot number between 10 and 21.</p>
<pre class="r"><code>bubble(spdata[occu$Plot==19,], &quot;resid&quot;, col=c(&quot;blue&quot;, &quot;orange&quot;), main=&quot;Residuals&quot;,xlab=&quot;X-coordinates&quot;, ylab=&quot;Y-coordinates&quot;, alpha=0.15)## zoom in to plot 19</code></pre>
<p><img src="efs_sdm_files/figure-html/unnamed-chunk-6-1.png" /><!-- --></p>
<p><strong>Look at a few more plots zoomed-in yourself.</strong></p>
<div id="bubbles-what-might-a-bad-bubble-plot-look-like" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Bubbles: What might a ‘bad’ bubble plot look like?</h3>
<p><img src="efs_sdm_assets/bubbles.png" alt="alt text" width="70%"></p>
<p>What patterns do you see in positive (orange) vs negative (blue) residuals plotted in space? What is a next course of action to remove this pattern?</p>
</div>
<div id="semivariograms-more-formal-than-bubble-plots" class="section level3">
<h3><span class="header-section-number">3.1.2</span> SemiVariograms, more formal than bubble plots</h3>
<p>Variograms: What do they mean?</p>
<p><img src="efs_sdm_assets/variogram.png" alt="alt text" width="70%"></p>
<p><strong>Range</strong>: distance after which the semivariance flattens out. Sampling locations closer to each other than the range are spatially autocorrelated.</p>
<p><strong>Nugget</strong>: Amount of variation at ranges smaller than those sampled in the study (or distance=0). Can be attributed to measurement error.</p>
<p>Create a semivariogram for your fitted model.</p>
<pre class="r"><code>vario.mod1 &lt;- gstat::variogram(rstandard(sdm)~1, spdata)
plot(vario.mod1, cex=1.3, col=1,xlab=&quot;Distance (km)&quot;)</code></pre>
<p><img src="efs_sdm_files/figure-html/vario%20model-1.png" /><!-- --></p>
<p>Or we can look for patterns in specific directions:</p>
<pre class="r"><code>vario.mod1.4dir &lt;- gstat::variogram(rstandard(sdm)~1, spdata,alpha=c(0,45, 90, 135)) ## alpha indicates direction in degrees
plot(vario.mod1.4dir, cex=1.3, col=1,xlab=&quot;Distance (km)&quot;)</code></pre>
<p><img src="efs_sdm_files/figure-html/unnamed-chunk-7-1.png" /><!-- --></p>
<p><strong>Are your variograms relatively flat? Is there evidence of an upward slope before the plot levels-off? Is it only in a particular direction?</strong></p>
<p>If your residuals look ok, have a look at the estimates of your model.</p>
</div>
</div>
</div>
<div id="model-estimates" class="section level1">
<h1><span class="header-section-number">4</span> Model estimates</h1>
<pre class="r"><code>summary(sdm)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Occur ~ B1 + B4 + NDVI + Slope + Aspect + Dist_to_path, 
##     family = &quot;binomial&quot;, data = occu)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4502  -0.9482  -0.8793   1.3840   1.6482  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)   6.3850595  3.1658064   2.017  0.04371 * 
## B1           -0.1299822  0.0656129  -1.981  0.04759 * 
## B4            0.0270124  0.0098956   2.730  0.00634 **
## NDVI         -7.0313638  2.5836241  -2.722  0.00650 **
## Slope        -3.4115046  5.7030999  -0.598  0.54972   
## Aspect        0.0121515  0.0307807   0.395  0.69301   
## Dist_to_path  0.0012611  0.0008913   1.415  0.15710   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1729.0  on 1325  degrees of freedom
## Residual deviance: 1716.9  on 1319  degrees of freedom
## AIC: 1730.9
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="well">
<h2 id="your-turn-2"><span class="header-section-number">4</span> Your turn</h2>
<p>Just for fun…</p>
<p>If your residual indicate some leftover spatial autocorrelation, we should first try to account for it before moving on to predicting occurrence over a larger extent:</p>
<ol style="list-style-type: decimal">
<li>Account for autocorrelation with a correlated error term</li>
<li>Account for autocorrelation with coordinates as interacting fixed effects</li>
</ol>
<button data-toggle="collapse" class="btn btn-primary btn-sm round" data-target="#demo4">
Show Solution
</button>
<div id="demo4" class="collapse">
<pre class="r"><code>##fitting spatial correlation error terms is computationally costly, and only few packages are programmed for this functionality
##we&#39;ll try the glmmPQL function.. 
##glmmPQL requires a few particulars about input data however.. must be a &#39;mixed effect&#39; model (i.e., contains a random effect), cannot have repeated measures from same location; so we must first subset our data to fit this

sdm_pql &lt;- occu %&gt;%
  filter(CatchMonth==5) %&gt;%
  group_by(latitude, longitude) %&gt;% 
  filter(row_number(X) == 1)

sdm_cor &lt;- MASS::glmmPQL(Occur~ B1 + B4 + NDVI + Slope + Aspect + Dist_to_path, random=  ~ 1|Plot, correlation =  nlme::corExp(form = ~ &quot;longitude&quot; + &quot;latitude&quot; | Plot), family = binomial(link = &quot;logit&quot;), data = sdm_pql, verbose=FALSE)

# OR

sdm_cor&lt;-glm(Occur~ B1 + B4 + NDVI + Slope + Aspect + Dist_to_path + latitude*longitude, family=&quot;binomial&quot;, data=occu) ##but less flexible about the shape that spatial correlation can take</code></pre>
</div>
</div>
</div>
<div id="model-validation" class="section level1">
<h1><span class="header-section-number">5</span> Model validation</h1>
<p><strong>Models can be validated in (at least) three general ways.</strong> What have you used or seen before?</p>
<div id="internal-validation" class="section level3">
<h3><span class="header-section-number">5.0.1</span> Internal validation</h3>
<pre class="r"><code>## internal validation
pred.within &lt;- predict(sdm,type=&quot;response&quot;) #for each observed data point, what does the model predict as probability of occurrence?
## resub acc
## build testing dataframe using model predictions
modl &lt;- &quot;pred.glm&quot;  # add var to keep track of model
dat2 &lt;- cbind(modl, occu[11], pred.within)  # build dataframe w/sdm predictions
head(dat2)  # examine prediction dataframe</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["modl"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["Occur"],"name":[2],"type":["int"],"align":["right"]},{"label":["pred.within"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"pred.glm","2":"0","3":"0.3141177","_rn_":"1"},{"1":"pred.glm","2":"0","3":"0.3289293","_rn_":"2"},{"1":"pred.glm","2":"0","3":"0.3289293","_rn_":"3"},{"1":"pred.glm","2":"0","3":"0.4005297","_rn_":"4"},{"1":"pred.glm","2":"0","3":"0.3412110","_rn_":"5"},{"1":"pred.glm","2":"0","3":"0.3271410","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>## fitted vs observed plot
plot(dat2$Occur,dat2$pred.within)
abline(lm(dat2$pred.within~dat2$Occur))</code></pre>
<p><img src="efs_sdm_files/figure-html/validate-1.png" /><!-- --></p>
<p>However, in SDMs we are often interested in ‘binarizing’ our model output- rather than predicting probability of occurrence, we might want occurrence: yes/no</p>
<p>Therefore we need a way to binarize our probabilities, and then assess how ‘accurate’ our model + threshold is as a classifier</p>
<pre class="r"><code>## determine best threshold using PresenceAbsence package Sec7.1
##   see help(optimal.thresholds) for more info

#help(optimal.thresholds)   # options for optimizing threshold
mod.cut &lt;- optimal.thresholds(dat2, opt.methods = c(&quot;MaxKappa&quot;)) # default threshold=0.5
modcut.LR&lt;-mod.cut
mod.cut  # examine threshold=ObsPrev</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Method"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["pred.within"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"MaxKappa","2":"0.36"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="confusion-matrix-for-a-two-class-classification-problem" class="section level3">
<h3><span class="header-section-number">5.0.2</span> Confusion matrix for a two class classification problem</h3>
<p><img src="efs_sdm_assets/confusion.png" alt="alt text" width="70%"></p>
<p>Read more about confusion matrices, and more metrics for classification accuracy here: <a href="https://en.wikipedia.org/wiki/Confusion_matrix">Confusion matrix</a>.</p>
<p>What is model sensitivity? specificity? True skill statistic?</p>
<pre class="r"><code>## generate confusion matrix
mod1.cfmat &lt;- table(dat2[[2]], factor(as.numeric(dat2$pred.within &gt;= mod.cut$pred.within)))
mod1.cfmat  # examine</code></pre>
<pre><code>##    
##       0   1
##   0 515 337
##   1 239 235</code></pre>
<pre class="r"><code>#########
## calculate model accuracies with standard deviation=F
mod1.acc &lt;- presence.absence.accuracy(dat2, threshold = mod.cut$pred.within, st.dev = F)
tss &lt;- mod1.acc$sensitivity + mod1.acc$specificity - 1 # code TSS metric
mod1.acc &lt;- cbind(mod1.acc[1:7], tss)  # bind all metrics
mod1.acc[c(1, 4:5, 7:8)]  # examine accuracies</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["sensitivity"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["specificity"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["AUC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["tss"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"pred.within","2":"0.4957806","3":"0.6044601","4":"0.5575873","5":"0.1002407"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>mod1.acc</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["threshold"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["PCC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sensitivity"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["specificity"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Kappa"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["AUC"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["tss"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"pred.within","2":"0.36","3":"0.5656109","4":"0.4957806","5":"0.6044601","6":"0.09584488","7":"0.5575873","8":"0.1002407"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="in-sample-cross-validation" class="section level3">
<h3><span class="header-section-number">5.0.3</span> In-sample cross-validation</h3>
<p>In cross-validation, data are partitioned (either randomly, as below, or somehow strategically) into a number of `folds’ (usually 5-10). One at a time, each fold is removed, while the remaining data is used to re-fit the regression model and to predict on the held-out observations.</p>
<pre class="r"><code>## perform  10-fold validation; requires pkg DAAG
xfold10 &lt;- CVbinary(sdm, nfolds = 10, print.details = F) # 10fold
mod1.10f &lt;- xfold10$cvhat   # assign new name to 10fold estimates
dat2 &lt;- cbind(dat2,mod1.10f)  # bind all metrics
head(dat2)  ##compare to full model metrics</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["modl"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["Occur"],"name":[2],"type":["int"],"align":["right"]},{"label":["pred.within"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mod1.10f"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"pred.glm","2":"0","3":"0.3141177","4":"0.3122456","_rn_":"1"},{"1":"pred.glm","2":"0","3":"0.3289293","4":"0.3304870","_rn_":"2"},{"1":"pred.glm","2":"0","3":"0.3289293","4":"0.3291463","_rn_":"3"},{"1":"pred.glm","2":"0","3":"0.4005297","4":"0.4044971","_rn_":"4"},{"1":"pred.glm","2":"0","3":"0.3412110","4":"0.3337972","_rn_":"5"},{"1":"pred.glm","2":"0","3":"0.3271410","4":"0.3258155","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><strong>What does it mean if your cross-validation metrics are much lower than metrics from the full model?</strong></p>
<pre class="r"><code>##  xfold acc
mod1.cfmatX &lt;- table(dat2[[2]], factor(as.numeric(dat2$mod1.10f &gt;= mod.cut$pred.within)))
mod1.accX &lt;- presence.absence.accuracy(dat2, threshold = mod.cut$pred.within, st.dev = F)
tss&lt;- mod1.accX$sensitivity + mod1.accX$specificity - 1 # code TSS metric
mod1.accX &lt;- cbind(mod1.accX[1:7], tss) # bind all metrics
mod1.accX[c(1, 4:5, 7:8)]  # examine accuracies</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["chr"],"align":["left"]},{"label":["sensitivity"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["specificity"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["AUC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["tss"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"pred.within","2":"0.4957806","3":"0.6044601","4":"0.5575873","5":"0.10024068"},{"1":"mod1.10f","2":"0.4789030","3":"0.6009390","4":"0.5321495","5":"0.07984192"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="external-validation" class="section level3">
<h3><span class="header-section-number">5.0.4</span> External validation</h3>
<p>The strongest validation is external to the data sampled to fit the model. Ideally, we would fit our model (using internal cross-validation), then resample locations across a range of predictions made from the fitted model. We would then compare those new observations with what our model predicted.</p>
<p><strong>If you are happy with your model’s performance:</strong></p>
</div>
</div>
<div id="model-predictions" class="section level1">
<h1><span class="header-section-number">6</span> Model predictions</h1>
<div id="make-predictions-to-the-rest-of-the-region-based-on-your-model" class="section level3">
<h3><span class="header-section-number">6.0.1</span> Make predictions to the rest of the region based on your model</h3>
<pre class="r"><code>pred_stack&lt;-stack(occ_stack[[1]],occ_stack[[4]],occ_stack[[6]],occ_stack[[9]],occ_stack[[10]],occ_stack[[11]]) ##match this to the predictors that you chose for your specific model. !!Keep them in the same order as they went in to the model!!
pred.glm&lt;-predict(pred_stack,sdm,type=&quot;response&quot;)
plot(pred.glm)
points(occ_spdf,col=as.factor(occ_spdf$Occur))</code></pre>
<p><img src="efs_sdm_files/figure-html/predict-1.png" /><!-- --> Again, we might want to zoom in a bit closer to a specific field site. try the function <strong>drawExtent()</strong> to draw an outline around a cluster of plotted points. This will give you the coordinates to crop the data to in order to zoom in somewhere specific.</p>
<pre class="r"><code>#drawExtent()
plot19&lt;-extent(c(669663,  670096, 5317568, 5318135))
pred_crop&lt;-crop(pred.glm,extent(plot19))
plot(pred_crop)
points(occ_spdf,col=as.factor(occ_spdf$Occur))</code></pre>
<p><img src="efs_sdm_files/figure-html/unnamed-chunk-12-1.png" /><!-- --></p>
</div>
</div>
<div id="example-code-for-other-models" class="section level1">
<h1><span class="header-section-number">7</span> Example code for other models</h1>
<p>Other commonly used models include: <em>generalized additive models</em>, <em>random forest</em>, <em>maximum entropy models</em></p>
<p>You can read more about these models and SDMs in general here: <a href="https://www.annualreviews.org/doi/full/10.1146/annurev.ecolsys.110308.120159#">General SDMs</a>, <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1600-0587.2008.05505.x">SDM model comparisons</a>, <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.1365-2656.2008.01390.x">Regression Trees and Forests</a>, <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1472-4642.2010.00725.x">MaxEnt</a>, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1600-0587.2013.07872.x">MaxEnt2</a></p>
<p>Each model type has their own associated assumptions, strengths, and weaknesses, and no one is clearly the best for all applications.</p>
<p>Below you will find code to run a couple of these models using the data from above. The code is for example-purposes, to get a feel for how your inferences might change based on the models you choose. We do not go into detail on these models but feel free to contact me for more information if you are interested in more information! <a href="mailto:efstuber@gmail.com">email me!</a></p>
<pre class="r"><code>library(gam)</code></pre>
<pre><code>## Loading required package: splines</code></pre>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## Loaded gam 1.16</code></pre>
<pre class="r"><code>library(randomForest)</code></pre>
<pre><code>## randomForest 4.6-14</code></pre>
<pre><code>## Type rfNews() to see new features/changes/bug fixes.</code></pre>
<pre><code>## 
## Attaching package: &#39;randomForest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<pre class="r"><code>gam.model&lt;-gam(Occur~ s(B1) +s(B4) + s(NDVI) + s(Slope) + s(Aspect) + s(Dist_to_path), family=&quot;binomial&quot;, data = occu) #gam is not restricted to &#39;linear&#39; relationships between response and predictor, rather no functional forms are specified and gam will estimate using &#39;smoothed splines&#39; for highly flexible, non-linear relationships
plot(gam.model)</code></pre>
<p><img src="efs_sdm_files/figure-html/unnamed-chunk-13-1.png" /><!-- --><img src="efs_sdm_files/figure-html/unnamed-chunk-13-2.png" /><!-- --><img src="efs_sdm_files/figure-html/unnamed-chunk-13-3.png" /><!-- --><img src="efs_sdm_files/figure-html/unnamed-chunk-13-4.png" /><!-- --><img src="efs_sdm_files/figure-html/unnamed-chunk-13-5.png" /><!-- --><img src="efs_sdm_files/figure-html/unnamed-chunk-13-6.png" /><!-- --></p>
<pre class="r"><code># Prediction map
gammap &lt;- predict(pred_stack,gam.model,type=&quot;response&quot;)
plot(gammap)</code></pre>
<p><img src="efs_sdm_files/figure-html/unnamed-chunk-13-7.png" /><!-- --></p>
<pre class="r"><code>set.seed(1234)
rf.model &lt;- randomForest(Occur ~ B1 + B4 +  NDVI + Slope + Aspect + Dist_to_path, data = occu)</code></pre>
<pre><code>## Warning in randomForest.default(m, y, ...): The response has five or fewer
## unique values. Are you sure you want to do regression?</code></pre>
<pre class="r"><code>rfImp &lt;- importance(rf.model) #ranked variable &#39;importance&#39;
varImpPlot(rf.model)</code></pre>
<p><img src="efs_sdm_files/figure-html/unnamed-chunk-13-8.png" /><!-- --></p>
<pre class="r"><code>rfmap &lt;- predict(pred_stack,rf.model,type=&quot;response&quot;)# Prediction map
plot(rfmap)</code></pre>
<p><img src="efs_sdm_files/figure-html/unnamed-chunk-13-9.png" /><!-- --></p>
</div>
<div id="homework-exercise" class="section level1">
<h1><span class="header-section-number">8</span> Homework exercise</h1>
<p>You have access to 7 grassland bird presence/absence data sets: <em>DICK</em> = dickcissel, <em>EAME</em> = eastern meadowlark, <em>FISP</em> = field sparrow, <em>GRSP</em> = grasshopper sparrow, <em>NOBO</em> = northern bobwhite quail, <em>RWBL</em> = red-winged blackbird, <em>WEME</em> = western meadowlark. For this exercise, you will select 2 species for which you will investigate the spatial scale that predicts occurrence at a sampling location.</p>
<p>Occurrence data were based on aural point count surveys taken at various wildlife management areas across southern Nebraska during the breeding season. During a 3min period, observers would count the number of individuals of each species detected within a 500m radius. Count data were collapsed into binary 0/1 data for this exercise.</p>
<p>Your datasets include the proportions of woodland and grassland found in multiple ‘buffer’ radii around each sampling site, representing different ‘scales’ at which landcover data might predict bird occurrence.</p>
<div id="general-workflow" class="section level3">
<h3><span class="header-section-number">8.0.1</span> General workflow:</h3>
<ol style="list-style-type: decimal">
<li>Choose 2 target species of interest.</li>
<li>Think about what relationships these species might have with proportions of woodland and grassland in the surrounding area (e.g., linear? quadratic?).</li>
<li>Hypothesize whether bird occurrence at a location should be influenced by very local or relatively larger-scale landcover characteristics.</li>
<li>Try to justify the hypotheses.</li>
<li>Think about how you would test whether your hypothesized ‘scales’ are the ‘right’ ones.</li>
<li>Condunct the test- likely: fit a model or models including your hypothesized predictor variables for each species</li>
<li>Were your hypotheses supported?</li>
</ol>
</div>
<div id="homework-products" class="section level3">
<h3><span class="header-section-number">8.0.2</span> Homework products</h3>
<p>Come to class next week with example(s) of ways you might test which spatial scales are most informative in occupancy studies, and any possible assumptions that underly those methods. Be prepared to explain why you hypothesized that certain spatial scales might be more important than others, and whether your hypothesis was supported.</p>
</div>
<div id="warm-up-code" class="section level3">
<h3><span class="header-section-number">8.0.3</span> Warm-up code</h3>
<p>You might need the following packages installed and loaded:</p>
<pre class="r"><code>library(lme4)
library(sp)
library(rgdal)
library(corrplot)
library(gstat)
library(DAAG) 
library(PresenceAbsence)
library(dplyr)</code></pre>
<p>Read in some data</p>
<pre class="r"><code>#dataspp1&lt;-read.csv(&quot;path_to_where_you_downloaded_the_data/DICK_occ.csv&quot;, sep=&quot;,&quot;,header=TRUE)</code></pre>
<p>Look at the data structure and content using <strong>str()</strong> and <strong>head()</strong></p>
<p><em>Route.Point</em> indicates the sampling location <em>detN</em> was the species count <em>WMA</em> refers to the larger Wildlife Management Area where the survey site was nested inside <em>grass###m</em> refers to the proportions of grassland found within a ###m radius ‘buffer’ around the sampling location <em>trees###m</em> refers to the proportions of woodland found within a ###m radius ‘buffer’ around the sampling location</p>
</div>
</div>


<!-- give the footer some space -->
<br/>
<br/>

<footer id="site-footer">
  <div id="footer1">
  <a href="https://cmerow.github.io"><img src="img/cory.png" alt="logo" width=40px></a>
  <!--
  <a href="http://adamwilson.us/#contact"><i class="fa fa-envelope fa-2x"></i></a> 
  <a href="https://twitter.com/AdamWilsonLab"><i class="fa fa-twitter fa-2x"></i></a> 
  <a href="https://github.com/AdamMWilson"><i class="fa fa-github fa-2x"></i></a>
  -->
  </div>
  <div id="footer2">
  <a rel="license" property="http://creativecommons.org/ns#license"
  href="http://creativecommons.org/licenses/by/4.0/" ><img src="img/cc-by.svg" alt="cc-by"/></a> 
  </div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
