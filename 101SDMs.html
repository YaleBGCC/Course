<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Cory Merow" />


<title>Introduction to Species Distribution Modeling</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="cm_yeti_bootswatch.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ecology, Statistics, and Data Science with R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Head2_Schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Course Materials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Head1_CourseContent.html">About Course Content</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Module 1: Introduction to R</li>
    <li>
      <a href="00_CourseIntroductionFrame.html">1.0 Course Introduction</a>
    </li>
    <li>
      <a href="01_Rintro.html">1.1 First Steps</a>
    </li>
    <li>
      <a href="02_DataWrangling.html">1.2 Data Wrangling</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Module 2: Spatial Analysis in R</li>
    <li>
      <a href="05_Raster.html">2.1 Spatial Data</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Module 3: Species Distribution Models</li>
    <li>
      <a href="101SDMs.html">3.1 Basic SDMS</a>
    </li>
    <li class="divider"></li>
  </ul>
</li>
<li>
  <a href="Head3_Resources.html">Resources</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cmerow/RDataScience/tree/gh-pages">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Introduction to Species Distribution Modeling</h1>
<h4 class="author"><em><a href="cmerow.github.io">Cory Merow</a></em></h4>
<h4 class="date"><em><a href="bgc.yale.edu">Yale Center for Global Change</a></em></h4>

</div>


<!-- <div> -->
<!-- <iframe src="05_presentation/05_Spatial.html" width="100%" height="700px"> </iframe> -->
<!-- </div> -->
<p><a href="101SDMs.R"><i class="fa fa-file-code-o fa-3x" aria-hidden="true"></i> The R Script associated with this page is available here</a>. Download this file and open it (or copy-paste into a new script) with RStudio so you can follow along.</p>
<div id="setup" class="section level1">
<h1><span class="header-section-number">1</span> Setup</h1>
<pre class="r"><code>library(spocc)
library(raster)
library(sp)
library(rgdal)
library(ROCR)
library(corrplot)</code></pre>
</div>
<div id="the-worst-sdm-ever" class="section level1">
<h1><span class="header-section-number">2</span> The worst SDM ever</h1>
<p>The goal of this is to use the simplest possible set of operations to build an SDM. There are many packages that will perform much more refined versions of these steps, at the expense that decisions are made behind the scenes, or may be obscure to the user, especially if s/he is not big on reading help files. So before getting into the fancy tools, let’s see what the bare minimum looks like.</p>
<blockquote>
<p>This is not the simplest possible code, because it requires some familiarity with the internal components of different spatial objects. The tradeoff is that none of the key operations are performed behind the scenes by specialized SDM functions. I realize this is not always pretty, but I hope for that reason it can demonstrate some coding gynmastics for beginners.</p>
</blockquote>
<div id="get-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Get data</h2>
<pre class="r"><code># get presence data
# pres=occ(&#39;Alliaria petiolata&#39;,from=&#39;gbif&#39;,limit=5000) # this can be slow
# so just read in the result of me running this earlier
#write.csv(pres$gbif$data[[1]],file=&#39;/Users/ctg/Dropbox/Projects/Workshops/YaleBGCCourses/101_assets/AP_gbif.csv&#39;)
pres=read.csv(&#39;~/Dropbox/Projects/Workshops/YaleBGCCourses/101_assets/AP_gbif.csv&#39;)[,c(&#39;longitude&#39;,&#39;latitude&#39;)]
pres=pres[complete.cases(pres),] # toss records without coords
# for direct download
# pres=read.csv(&#39;https://cmerow.github.io/YaleBGCCourses/101_assets/AP_gbif.csv&#39;)

# get climate data
clim=getData(&#39;worldclim&#39;, var=&#39;bio&#39;, res=10) </code></pre>
</div>
<div id="choose-domain" class="section level2">
<h2><span class="header-section-number">2.2</span> Choose domain</h2>
<pre class="r"><code># choose domain (just the Eastern US)
clim.us=raster::crop(clim,c(-100,-50,25,50)) # trim to a smaller region
plot(clim.us) # view </code></pre>
<p><img src="101SDMs_files/figure-html/unnamed-chunk-4-1.png" /><!-- --></p>
<p>The Bioclim variables in <code>clim.us</code> are:</p>
<p><small></p>
<table>
<thead>
<tr class="header">
<th>Varia</th>
<th>ble Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>BIO1</td>
<td>Annual Mean Temperature</td>
</tr>
<tr class="even">
<td>BIO2</td>
<td>Mean Diurnal Range (Mean of monthly (max temp – min temp))</td>
</tr>
<tr class="odd">
<td>BIO3</td>
<td>Isothermality (BIO2/BIO7) (* 100)</td>
</tr>
<tr class="even">
<td>BIO4</td>
<td>Temperature Seasonality (standard deviation *100)</td>
</tr>
<tr class="odd">
<td>BIO5</td>
<td>Max Temperature of Warmest Month</td>
</tr>
<tr class="even">
<td>BIO6</td>
<td>Min Temperature of Coldest Month</td>
</tr>
<tr class="odd">
<td>BIO7</td>
<td>Temperature Annual Range (BIO5-BIO6)</td>
</tr>
<tr class="even">
<td>BIO8</td>
<td>Mean Temperature of Wettest Quarter</td>
</tr>
<tr class="odd">
<td>BIO9</td>
<td>Mean Temperature of Driest Quarter</td>
</tr>
<tr class="even">
<td>BIO10</td>
<td>Mean Temperature of Warmest Quarter</td>
</tr>
<tr class="odd">
<td>BIO11</td>
<td>Mean Temperature of Coldest Quarter</td>
</tr>
<tr class="even">
<td>BIO12</td>
<td>Annual Precipitation</td>
</tr>
<tr class="odd">
<td>BIO13</td>
<td>Precipitation of Wettest Month</td>
</tr>
<tr class="even">
<td>BIO14</td>
<td>Precipitation of Driest Month</td>
</tr>
<tr class="odd">
<td>BIO15</td>
<td>Precipitation Seasonality (Coefficient of Variation)</td>
</tr>
<tr class="even">
<td>BIO16</td>
<td>Precipitation of Wettest Quarter</td>
</tr>
<tr class="odd">
<td>BIO17</td>
<td>Precipitation of Driest Quarter</td>
</tr>
<tr class="even">
<td>BIO18</td>
<td>Precipitation of Warmest Quarter</td>
</tr>
<tr class="odd">
<td>BIO19</td>
<td>Precipitation of Coldest Quarter</td>
</tr>
</tbody>
</table>
<p></small></p>
</div>
<div id="prep-data" class="section level2">
<h2><span class="header-section-number">2.3</span> Prep data</h2>
<pre class="r"><code># check for correlated predictors
cors=cor(values(clim.us),use=&#39;complete.obs&#39;)
corrplot(cors,order = &quot;AOE&quot;, addCoef.col = &quot;grey&quot;,number.cex=.6)</code></pre>
<p><img src="101SDMs_files/figure-html/unnamed-chunk-5-1.png" /><!-- --></p>
<pre class="r"><code>clim=clim[[c(&#39;bio1&#39;,&#39;bio2&#39;,&#39;bio13&#39;,&#39;bio14&#39;)]]
clim.us=clim.us[[c(&#39;bio1&#39;,&#39;bio2&#39;,&#39;bio13&#39;,&#39;bio14&#39;)]]
cors=cor(values(clim.us),use=&#39;complete.obs&#39;)
corrplot(cors,order = &quot;AOE&quot;, addCoef.col = &quot;grey&quot;,number.cex=.6)</code></pre>
<p><img src="101SDMs_files/figure-html/unnamed-chunk-6-1.png" /><!-- --></p>
<p>Ok, tolerable.</p>
<pre class="r"><code># scale each predictor to mean=0, variance=1
clim.means=apply(values(clim.us),2,mean,na.rm=T) # means
clim.sds=apply(values(clim.us),2,sd,na.rm=T) # standard devations
values(clim.us)=sapply(1:nlayers(clim.us),function(x) (values(clim.us)[,x]-clim.means[x])/clim.sds[x]) # z-scores

# get environment at pres points
coordinates(pres)=c(&#39;longitude&#39;,&#39;latitude&#39;) # set coords to allow extraction (next line)
pres.data=data.frame(raster::extract(clim.us,pres)) # extract data at pres locations
coordinates(pres.data)=coordinates(pres) # make sure the data have coords associated
pres.data=pres.data[complete.cases(pres.data@data),] # toss points without env data</code></pre>
</div>
<div id="sample-background" class="section level2">
<h2><span class="header-section-number">2.4</span> Sample background</h2>
<pre class="r"><code># sample background (to compare against presences)
all.background=which(complete.cases(values(clim.us))) # find cells on land
bg.index=sample(all.background,10000) # take random sample of land
bg.data=data.frame(values(clim.us)[bg.index,]) # get the env at these cells
coordinates(bg.data)=coordinates(clim.us)[bg.index,] # define spatial object</code></pre>
<pre class="r"><code># prep data for use in glm()
all.data=rbind(data.frame(pres=1,pres.data@data),data.frame(pres=0,bg.data@data))

# specify formula (quickly to avoid writing out every name)
(form=paste(&#39;pres~&#39;, 
            paste(names(all.data)[-1], collapse = &quot; + &quot;),&#39;+&#39;,
            paste(&quot;I(&quot;, names(all.data)[-1], &quot;^2)&quot;, sep = &quot;&quot;, collapse = &quot; + &quot;)))</code></pre>
<pre><code>## [1] &quot;pres~ bio1 + bio2 + bio13 + bio14 + I(bio1^2) + I(bio2^2) + I(bio13^2) + I(bio14^2)&quot;</code></pre>
</div>
<div id="statistical-model" class="section level2">
<h2><span class="header-section-number">2.5</span> Statistical model</h2>
<pre class="r"><code># fit model
all.data$weight = all.data$pres + (1 - all.data$pres) * 100 # these allow you to fit a Point Process
mod.worst=glm(form,data=all.data,family=poisson(link=&#39;log&#39;),weights=weight)</code></pre>
<pre><code>## Warning: glm.fit: fitted rates numerically 0 occurred</code></pre>
<pre class="r"><code>summary(mod.worst)</code></pre>
<pre><code>## 
## Call:
## glm(formula = form, family = poisson(link = &quot;log&quot;), data = all.data, 
##     weights = weight)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.5855  -0.3526  -0.0762  -0.0086   4.5013  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -6.38136    0.09481 -67.306  &lt; 2e-16 ***
## bio1         0.83602    0.11945   6.999 2.58e-12 ***
## bio2        -1.03475    0.08266 -12.518  &lt; 2e-16 ***
## bio13       -1.81910    0.16570 -10.978  &lt; 2e-16 ***
## bio14        0.87422    0.05456  16.023  &lt; 2e-16 ***
## I(bio1^2)   -3.63591    0.22200 -16.378  &lt; 2e-16 ***
## I(bio2^2)   -0.67464    0.06435 -10.484  &lt; 2e-16 ***
## I(bio13^2)  -0.90681    0.14148  -6.410 1.46e-10 ***
## I(bio14^2)   0.38417    0.05821   6.599 4.13e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 11875.0  on 10837  degrees of freedom
## Residual deviance:  9571.7  on 10829  degrees of freedom
## AIC: 11266
## 
## Number of Fisher Scoring iterations: 13</code></pre>
</div>
<div id="inspect-response-curves" class="section level2">
<h2><span class="header-section-number">2.6</span> Inspect response curves</h2>
<pre class="r"><code># check response curves
  # these marginal response curves are evaluated at the means of the non-focal predictor
clim.ranges=apply(values(clim.us),2,range,na.rm=T) # upper and lower limits for each variable
dummy.mean.matrix=data.frame(matrix(0,ncol=nlayers(clim.us),nrow=100)) #makes prediction concise below
names(dummy.mean.matrix)=colnames(clim.ranges)
response.curves=lapply(1:nlayers(clim.us),function(x){ # loop over each variable
  xs=seq(clim.ranges[1,x],clim.ranges[2,x],length=100)
  newdata=dummy.mean.matrix
  newdata[,x]=xs
  ys=predict(mod.worst,newdata=newdata)
  return(data.frame(xs=xs,ys=ys)) # define outputs
})# ignore warnings</code></pre>
<pre class="r"><code>str(response.curves)</code></pre>
<pre><code>## List of 4
##  $ :&#39;data.frame&#39;:    100 obs. of  2 variables:
##   ..$ xs: num [1:100] -1.74 -1.7 -1.66 -1.62 -1.58 ...
##   ..$ ys: num [1:100] -18.9 -18.3 -17.8 -17.2 -16.7 ...
##  $ :&#39;data.frame&#39;:    100 obs. of  2 variables:
##   ..$ xs: num [1:100] -4.31 -4.24 -4.17 -4.1 -4.03 ...
##   ..$ ys: num [1:100] -14.5 -14.1 -13.8 -13.5 -13.2 ...
##  $ :&#39;data.frame&#39;:    100 obs. of  2 variables:
##   ..$ xs: num [1:100] -1.93 -1.86 -1.79 -1.71 -1.64 ...
##   ..$ ys: num [1:100] -6.25 -6.13 -6.02 -5.92 -5.84 ...
##  $ :&#39;data.frame&#39;:    100 obs. of  2 variables:
##   ..$ xs: num [1:100] -1.84 -1.78 -1.72 -1.66 -1.6 ...
##   ..$ ys: num [1:100] -6.69 -6.72 -6.75 -6.77 -6.8 ...</code></pre>
<pre class="r"><code>  # plot the curves
par(mfrow=c(4,5),mar=c(4,5,.5,.5))
for(i in 1:nlayers(clim)){
  plot(response.curves[[i]]$xs,response.curves[[i]]$ys,
       type=&#39;l&#39;,bty=&#39;n&#39;,las=1,xlab=colnames(clim.ranges)[i],ylab=&#39;occurence rate&#39;,ylim=c(-20,20))
}</code></pre>
<p><img src="101SDMs_files/figure-html/unnamed-chunk-13-1.png" /><!-- --></p>
</div>
<div id="map-predictions" class="section level2">
<h2><span class="header-section-number">2.7</span> Map predictions</h2>
<pre class="r"><code># predict to US
pred=predict(mod.worst,newdata=data.frame(values(clim.us)))
pred=pred/sum(pred,na.rm=T)
pred.r=clim.us[[1]] # dummy raster with right structure
values(pred.r)=pred 
plot(pred.r)
plot(pres,add=T)</code></pre>
<p><img src="101SDMs_files/figure-html/unnamed-chunk-14-1.png" /><!-- --></p>
</div>
<div id="evaluate-performance" class="section level2">
<h2><span class="header-section-number">2.8</span> Evaluate performance</h2>
<pre class="r"><code># evaluate
pred.at.fitting.pres=raster::extract(pred.r,pres.data)
pred.at.fitting.bg=raster::extract(pred.r,bg.data)
rocr.pred=ROCR::prediction(predictions=c(pred.at.fitting.pres,pred.at.fitting.bg),
                          labels=c(rep(1,length(pred.at.fitting.pres)),rep(0,length(pred.at.fitting.bg))))
perf.fit=performance(rocr.pred,measure = &quot;tpr&quot;, x.measure = &quot;fpr&quot;)
plot(perf.fit)
abline(0,1)</code></pre>
<p><img src="101SDMs_files/figure-html/unnamed-chunk-15-1.png" /><!-- --></p>
<pre class="r"><code>(auc_ROCR &lt;- performance(rocr.pred, measure = &quot;auc&quot;)@y.values[[1]])</code></pre>
<pre><code>## [1] 0.09439851</code></pre>
</div>
<div id="transfer-to-new-conditions" class="section level2">
<h2><span class="header-section-number">2.9</span> Transfer to new conditions</h2>
<pre class="r"><code># transfer to Europe
# choose domain (just the europe)
clim.eu=raster::crop(clim,c(-10,55,30,75))
values(clim.eu)=sapply(1:nlayers(clim.eu),function(x) (values(clim.eu)[,x]-clim.means[x])/clim.sds[x]) # z-scores
transfer=predict(mod.worst,newdata=data.frame(values(clim.eu)))
transfer=transfer/sum(transfer,na.rm=T)
transfer.r=clim.eu[[1]]
values(transfer.r)=transfer
plot(transfer.r)
plot(pres,add=T)</code></pre>
<p><img src="101SDMs_files/figure-html/unnamed-chunk-16-1.png" /><!-- --></p>
<!-- # # evaluate transfer -->
<!-- # pred.at.transfer.pres=raster::extract(transfer.r,pres.data) -->
<!-- #   # sample background in transfer region -->
<!-- # all.background=which(complete.cases(values(clim.us))) -->
<!-- # bg.index=sample(all.background,10000) -->
<!-- # bg.data=data.frame(values(clim.us)[bg.index,]) -->
<!-- # coordinates(bg.data)=coordinates(clim.us)[bg.index,] -->
<!-- #  -->
<!-- # transfer.bg= -->
<!-- # pred.at.fitting.bg=raster::extract(transfer.r,bg.data) -->
<!-- # rocr.pred=ROCR::prediction(predictions=c(pred.at.fitting.pres,pred.at.fitting.bg), -->
<!-- #                           labels=c(rep(1,length(pred.at.fitting.pres)),rep(0,length(pred.at.fitting.bg)))) -->
<!-- # perf.fit=performance(rocr.pred,measure = "tpr", x.measure = "fpr") -->
<!-- # plot(perf.fit) -->
<!-- # abline(0,1) -->
<!-- # (auc_ROCR <- performance(rocr.pred, measure = "auc")@y.values[[1]]) -->
<!-- #  -->
</div>
</div>
<div id="improvements" class="section level1">
<h1><span class="header-section-number">3</span> Improvements</h1>
<div id="thin-presences-stratify-sampling" class="section level2">
<h2><span class="header-section-number">3.1</span> Thin presences, Stratify sampling</h2>
</div>
<div id="sampling-bias" class="section level2">
<h2><span class="header-section-number">3.2</span> Sampling bias</h2>
</div>
<div id="model-comparison" class="section level2">
<h2><span class="header-section-number">3.3</span> Model comparison</h2>
</div>
<div id="other-algorithms-glmnet" class="section level2">
<h2><span class="header-section-number">3.4</span> Other algorithms: glmnet</h2>
</div>
</div>


<!-- give the footer some space -->
<br/>
<br/>

<footer id="site-footer">
  <div id="footer1">
  <a href="https://cmerow.github.io"><img src="img/cory.png" alt="logo" width=40px></a>
  <!--
  <a href="http://adamwilson.us/#contact"><i class="fa fa-envelope fa-2x"></i></a> 
  <a href="https://twitter.com/AdamWilsonLab"><i class="fa fa-twitter fa-2x"></i></a> 
  <a href="https://github.com/AdamMWilson"><i class="fa fa-github fa-2x"></i></a>
  -->
  </div>
  <div id="footer2">
  <a rel="license" property="http://creativecommons.org/ns#license"
  href="http://creativecommons.org/licenses/by/4.0/" ><img src="img/cc-by.svg" alt="cc-by"/></a> 
  </div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
